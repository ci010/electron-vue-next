<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>electron-vue-next | Electron Vue Next</title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/electron-vue-next/assets/style.b3e4d275.css">
    <link rel="modulepreload" href="/electron-vue-next/assets/Home.1eb22c64.js">
    <link rel="modulepreload" href="/electron-vue-next/assets/app.dc01decd.js">
    <link rel="modulepreload" href="/electron-vue-next/assets/index.md.684eda04.lean.js">
    <link rel="modulepreload" href="/electron-vue-next/assets/app.dc01decd.js">
    <meta name="twitter:title" content="electron-vue-next | Electron Vue Next">
    <meta property="og:title" content="electron-vue-next | Electron Vue Next">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-7161a24b><div class="sidebar-button" data-v-7161a24b><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/electron-vue-next/" aria-label="Electron Vue Next, back to home" data-v-7161a24b data-v-4a583abe><!----> Electron Vue Next</a><div class="flex-grow" data-v-7161a24b></div><div class="nav" data-v-7161a24b><nav class="nav-links" data-v-7161a24b data-v-81ef9e7e><!----><!----><div class="item" data-v-81ef9e7e><div class="nav-link" data-v-81ef9e7e data-v-641633f9><a class="item isExternal" href="https://github.com/ci010/electron-vue-next" target="_blank" rel="noopener noreferrer" data-v-641633f9>Github <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-641633f9><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-6b49cdcd><nav class="nav-links nav" data-v-6b49cdcd data-v-81ef9e7e><!----><!----><div class="item" data-v-81ef9e7e><div class="nav-link" data-v-81ef9e7e data-v-641633f9><a class="item isExternal" href="https://github.com/ci010/electron-vue-next" target="_blank" rel="noopener noreferrer" data-v-641633f9>Github <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-641633f9><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-6b49cdcd><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="#features">Features</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#quick-start">Quick Start</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#config-your-project-and-build">Config Your Project and Build</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#project-structure">Project Structure</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#file-tree">File Tree</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#main-and-renderer-processes">Main and Renderer Processes</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#npm-scripts">NPM Scripts</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#development">Development</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#service">Service</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#static-resource">Static Resource</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#preload-script">Preload Script</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#hooks-or-composable-in-renderer-process">Hooks or Composable in Renderer Process</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#electron-api-in-renderer-process">Electron API in Renderer Process</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dependencies">Dependencies</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#new-window">New Window</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#worker-threads">Worker Threads</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#debugging">Debugging</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#option-using-node-modules-in-renderer-process">Option: Using Node Modules in Renderer Process</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#build">Build</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#compile">Compile</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#exclude-files">Exclude Files</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#release">Release</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#autoupdate-support">AutoUpdate Support</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="electron-vue-next"><a class="header-anchor" href="#electron-vue-next" aria-hidden="true">#</a> electron-vue-next</h1><p>This repository contains the starter template for using vue-next with the latest electron.</p><p><em>I started to learn electron &amp; vue by the great project <a href="https://github.com/SimulatedGREG/electron-vue" target="_blank" rel="noopener noreferrer">electron-vue</a>. This project is also inspired from it.</em></p><p><em>Holpfully, you generally learn how to use rollup &amp; its plugin API from this project</em> ðŸ˜ƒ</p><h2 id="features"><a class="header-anchor" href="#features" aria-hidden="true">#</a> Features</h2><ul><li>Electron 11 <ul><li>Follow the <a href="https://www.electronjs.org/docs/tutorial/security" target="_blank" rel="noopener noreferrer">security</a> guide of electron, make renderer process a browser only environment</li><li>Using <a href="https://github.com/electron-userland/electron-builder" target="_blank" rel="noopener noreferrer">electron-builder</a> to build</li></ul></li><li>Empower <a href="https://github.com/vuejs/vue-next" target="_blank" rel="noopener noreferrer">vue-next</a> and its eco-system <ul><li>Using <a href="https://github.com/vitejs/vite" target="_blank" rel="noopener noreferrer">vite</a> which means develop renderer process can be blazingly fast!</li><li>Using <a href="https://github.com/vuejs/vuex/tree/4.0" target="_blank" rel="noopener noreferrer">vuex 4.0</a> with strong type state, getters, and commit</li><li>Using <a href="https://github.com/vuejs/vue-router-next" target="_blank" rel="noopener noreferrer">vue-router-next</a></li></ul></li><li>Using <a href="https://www.npmjs.com/package/eslint" target="_blank" rel="noopener noreferrer">eslint</a> with Javascript Standard by default</li><li>Built-in TypeScript Support <ul><li>Using <a href="https://github.com/evanw/esbuild" target="_blank" rel="noopener noreferrer">esbuild</a> in <a href="https://github.com/rollup/rollup" target="_blank" rel="noopener noreferrer">rollup</a> (align with vite) to build main process typescript code</li><li>Built-in a typescript rollup plugin to typecheck</li></ul></li><li>NodeJS <code>worker_threads</code> workflow out-of-box <ul><li>Don&#39;t need to worry the worker threads bundle/build when you use it.</li></ul></li><li>Preload scripts build workflow out-of-box <ul><li>No need to worry about the bundle/build of electron preload script.</li><li>Built-in support for preload reload in DEV mode. Changing preload scripts won&#39;t restart the whole electron app</li></ul></li><li>Github Action with Github Release is out-of-box <ul><li>Auto bump version in package.json and generate <a href="http://CHANGELOG.md" target="_blank" rel="noopener noreferrer">CHANGELOG.md</a> if you follow the <a href="https://www.conventionalcommits.org/en/v1.0.0" target="_blank" rel="noopener noreferrer">Conventional Commits</a></li><li>Detail how this work described in <a href="#release-process">Release Process</a> section</li></ul></li><li>Integrate VSCode well <ul><li>Support debug .ts/.vue files in main/renderer process by vscode debugger</li><li>Detail see <a href="#debugging">Debug</a> section</li></ul></li><li>Multiple Windows Support <ul><li>Can add a new window for App easily. See <a href="#new-window">Add a New Window</a> section</li></ul></li><li><a href="https://github.com/vuejs/vue-devtools" target="_blank" rel="noopener noreferrer">vue-devtool</a> support <ul><li>Run npm run postinstall to install extensions</li><li>Support vue-router-next and vuex 4 with new UI</li></ul></li></ul><h2 id="quick-start"><a class="header-anchor" href="#quick-start" aria-hidden="true">#</a> Quick Start</h2><p>You should use <code>npm init</code> to create the project from template: <code>npm init electron-vue-next</code>.</p><p>Once you&#39;re done, you can run following commands:</p><div class="language-shell"><pre><code><span class="token comment"># Install dependencies</span>
<span class="token function">npm</span> <span class="token function">install</span>

<span class="token comment"># Will start vite server, rollup devserver, and electron to dev!</span>
<span class="token function">npm</span> run dev

<span class="token comment"># OPTIONAL. Will compile the main and renderer process to javascript and display output size</span>
<span class="token function">npm</span> run build

<span class="token comment"># OPTIONAL. Will compile all and output an unpacked electron app. You can directly </span>
<span class="token function">npm</span> run build:dir

<span class="token comment"># Will compile all and build all products and ready to release</span>
<span class="token function">npm</span> run build:production

</code></pre></div><h3 id="config-your-project-and-build"><a class="header-anchor" href="#config-your-project-and-build" aria-hidden="true">#</a> Config Your Project and Build</h3><p>Once you install your project, you should change the package base info in <a href="https://github.com/ci010/electron-vue-next/tree/master/electron-vue-next/package.json" target="_blank" rel="noopener noreferrer">package.json</a>, and also the build information in <a href="https://github.com/ci010/electron-vue-next/tree/master/electron-vue-next/scripts/build.base.config.js" target="_blank" rel="noopener noreferrer">build.base.config.js</a>.</p><h2 id="project-structure"><a class="header-anchor" href="#project-structure" aria-hidden="true">#</a> Project Structure</h2><h3 id="file-tree"><a class="header-anchor" href="#file-tree" aria-hidden="true">#</a> File Tree</h3><p>Your workspace should looks like</p><div class="language-"><pre><code>your-project
â”œâ”€ scripts                 all dev scripts, build script directory
â”œâ”€ extensions              temp folder of the vue-devtools extension
â”œâ”€ build                   build resource and output directory
â”‚  â””â”€ icons/               build icon directory
â”œâ”€ dist                    compiled output directory
â”œâ”€ src
â”‚  â”œâ”€ main
â”‚  â”‚  â”œâ”€ services/         services to access the network or files
â”‚  â”‚  â”œâ”€ workers/          multi-thread scripts using nodejs worker_threads
â”‚  â”‚  â”œâ”€ dialog.ts         the ipc handler to support dialog API from renderer process
â”‚  â”‚  â”œâ”€ global.ts         typescript global definition
â”‚  â”‚  â”œâ”€ index.dev.ts      the development rollup entry
â”‚  â”‚  â”œâ”€ index.ts          real electron start-up entry file
â”‚  â”‚  â””â”€ logger.ts         a simple logger implementation
â”‚  â”œâ”€ preload
â”‚  â”‚  â”œâ”€ index.ts          the preload entry
â”‚  â”‚  â””â”€ another.ts        another preload entry
â”‚  â”œâ”€ renderer
â”‚  â”‚  â”œâ”€ assets/           assets directoy
â”‚  â”‚  â”œâ”€ components/       all vue components
â”‚  â”‚  â”œâ”€ hooks/            hooks or composition API
â”‚  â”‚  â”œâ”€ router.ts         vue-router initializer
â”‚  â”‚  â”œâ”€ store.ts          vuex store initializer
â”‚  â”‚  â”œâ”€ App.vue           entry vue file imported by index.ts
â”‚  â”‚  â”œâ”€ index.css         entry css file for vite
â”‚  â”‚  â”œâ”€ index.html        entry html file for vite
â”‚  â”‚  â””â”€ index.ts          entry script file for vite
â”‚  â””â”€ shared               shared folder can be access from both main and renderer side
â”‚     â”œâ”€ store/            vuex store definition
â”‚     â””â”€ sharedLib.ts      an example file that can be access from both side
â”œâ”€ static/                 static resource directory
â”œâ”€ .eslintrc.js
â”œâ”€ .gitignore
â”œâ”€ package.json
â””â”€ README.md
</code></pre></div><h4 id="assets-static-resources-build-resources-what-s-the-difference"><a class="header-anchor" href="#assets-static-resources-build-resources-what-s-the-difference" aria-hidden="true">#</a> assets, static resources, build resources... what&#39;s the difference?</h4><p>The assets is only used by the renderer process (in-browser display), like picture or font. They are <strong>bundled by vite/rollup</strong>. You can directly <code>import</code> them in <code>.vue/.ts</code> files under renderer directory. The default assets are in <a href="https://github.com/ci010/electron-vue-next/tree/master/electron-vue-next/src/renderer/assets" target="_blank" rel="noopener noreferrer">renderer/renderer/assets</a></p><p>The static resources are the static files which main process wants to access (like read file content) in <strong>runtime vie file system</strong>. They might be the tray icon file, browser window icon file. The static folder is at <a href="https://github.com/ci010/electron-vue-next/tree/master/electron-vue-next/static" target="_blank" rel="noopener noreferrer">static</a>.</p><p>The build resources are used by <code>electron-builder</code> to build the installer. They can be your program icon of installer, or installer script. Default build icons are under <a href="https://github.com/ci010/electron-vue-next/tree/master/electron-vue-next/build/icons" target="_blank" rel="noopener noreferrer">build/icons</a>.</p><p><em>Notice that your program icon can show up in multiple place! Don&#39;t mixup them!</em></p><ul><li><em>In build icons, of course you want your program has correct icon.</em></li><li><em>In static directory, sometime you want your program has <strong>tray</strong> which require icon in static directory.</em></li><li><em>In assets, sometime you want to display your program icon inside a page. You need to place them in the assets!</em></li></ul><h3 id="main-and-renderer-processes"><a class="header-anchor" href="#main-and-renderer-processes" aria-hidden="true">#</a> Main and Renderer Processes</h3><p>Quote from electron official document about <a href="https://www.electronjs.org/docs/tutorial/quick-start#main-and-renderer-processes" target="_blank" rel="noopener noreferrer">main and renderer processes</a>. The main process is about</p><blockquote><ul><li>The Main process creates web pages by creating BrowserWindow instances. Each BrowserWindow instance runs the web page in its Renderer process. When a BrowserWindow instance is destroyed, the corresponding Renderer process gets terminated as well.</li><li>The Main process manages all web pages and their corresponding Renderer processes.</li></ul></blockquote><p>And the renderer process is about</p><blockquote><ul><li>The Renderer process manages only the corresponding web page. A crash in one Renderer process does not affect other Renderer processes.</li><li>The Renderer process communicates with the Main process via IPC to perform GUI operations in a web page. Calling native GUI-related APIs from the Renderer process directly is restricted due to security concerns and potential resource leakage.</li></ul></blockquote><p>Commonly, the main process is about your core business logic, and renderer side act as a data consumer to render the UI. Though, this is not absolutly right. Someone thinks the main process should not do any job other than communicating with system API (by electron API), since once the main process is blocked, the whole app will be blocked (not responsed). So if you have some really CPU heavy job, you definitly should not put them in the main process (Most of IO job in nodejs are async, that&#39;s fine). Maybe you can use the nodejs <a href="https://nodejs.org/api/worker_threads.html" target="_blank" rel="noopener noreferrer">worker_thread</a> module to put them into another thread, so it won&#39;t make the whole app not responsable.</p><p>So this design is depend on your core business type. If it&#39;s a IO heavy job, it&#39;s fine to put them in main process. If it&#39;s a CPU heavy job, you need to consider not to put them much in main process.</p><p>Following the <a href="https://www.electronjs.org/docs/tutorial/security" target="_blank" rel="noopener noreferrer">security</a> guideline of electron, in this boilerplate, the renderer process <a href="https://www.electronjs.org/docs/tutorial/security#2-do-not-enable-nodejs-integration-for-remote-content" target="_blank" rel="noopener noreferrer"><strong>does not</strong> have access to nodejs module by default</a>. The electron provide the <code>preload</code> options in <code>webPreferences</code>. This boilerplate provides one simple way to solve this problem, wrapping your core logic into <code>Service</code>.</p><p>The <code>Service</code> is a type of class defined under the <code>src/main/services</code>. All the public method can be access by the renderer process. It&#39;s the bridge between the main and renderer. You can look at <a href="#service">Service</a> for the detail.</p><p><em><strong>Notice that this is really a simple/trivial solution which derives from my personal electron project (much complex case). It only shows a possibility. Real life software might need more modifications on it!</strong></em></p><h3 id="npm-scripts"><a class="header-anchor" href="#npm-scripts" aria-hidden="true">#</a> NPM Scripts</h3><h4 id="npm-run-dev"><a class="header-anchor" href="#npm-run-dev" aria-hidden="true">#</a> <code>npm run dev</code></h4><p>Start the vite dev server hosting the renderer webpage with hot reloading. Start the rollup server hosting the main process script. It will auto reload the electron app if you modify the source files.</p><h4 id="npm-run-build"><a class="header-anchor" href="#npm-run-build" aria-hidden="true">#</a> <code>npm run build</code></h4><p>Compile both <code>main</code> and <code>renderer</code> process code to production, located at <code>dist</code></p><h4 id="npm-run-build-production"><a class="header-anchor" href="#npm-run-build-production" aria-hidden="true">#</a> <code>npm run build:production</code></h4><p>It will compile both processes, and then run <code>electron-builder</code> to build your app into executable installer or zip. The build config is defined in <a href="https://github.com/ci010/electron-vue-next/tree/master/electron-vue-next/scripts/build.base.config.js" target="_blank" rel="noopener noreferrer">scripts/build.base.config.js</a>.</p><h4 id="npm-run-build-dir"><a class="header-anchor" href="#npm-run-build-dir" aria-hidden="true">#</a> <code>npm run build:dir</code></h4><p>It will compile both processes, and it will run <code>electron-builder</code> to build only the directoy version of the production electron app, which for example, for windows x64, it&#39;s located at <code>build/win-unpacked</code>.</p><p>This will much faster than <code>npm run build:production</code>. So you can use it to quick testing the production app.</p><h4 id="npm-run-lint"><a class="header-anchor" href="#npm-run-lint" aria-hidden="true">#</a> <code>npm run lint</code></h4><p>Run eslint to report eslint error.</p><h4 id="npm-run-lint-fix"><a class="header-anchor" href="#npm-run-lint-fix" aria-hidden="true">#</a> <code>npm run lint:fix</code></h4><p>Run eslint to fix and report eslint error.</p><h2 id="development"><a class="header-anchor" href="#development" aria-hidden="true">#</a> Development</h2><p>Due to the project is following the <a href="https://www.electronjs.org/docs/tutorial/security" target="_blank" rel="noopener noreferrer">security</a> guideline. It does not allow the renderer to access node by default. The <a href="#service">Service</a> is a simple solution to isolate renderer logic and the core logic with full nodejs module access. See <a href="#option-using-node-modules-in-renderer-process">this</a> section if you want to directly use node modules in renderer process.</p><h3 id="service"><a class="header-anchor" href="#service" aria-hidden="true">#</a> Service</h3><p>A Service lives in a class in <code>src/main/services</code>. It should contain some of your core logic with file or network access in main process. It exposes these logic to renderer process. You call the hook <code>useService(&#39;NameOfService&#39;)</code> to use it in renderer side.</p><p>The concept of service is totally optional. This is a design for security. <em><strong>If you think this is redundent and not fit with your program design, you can just remove it.</strong></em></p><h4 id="create-a-new-service"><a class="header-anchor" href="#create-a-new-service" aria-hidden="true">#</a> Create a new Service</h4><p>Add a file to the <code>/src/main/services</code> named <code>BarService.ts</code></p><div class="language-ts"><pre><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">BarService</span> <span class="token keyword">extends</span> <span class="token class-name">Service</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">doSomeCoreLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// perform some file system or network work here</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And you need to add it to the <code>interface Services</code> in <code>src/main/services/index.ts</code>.</p><div class="language-ts"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> BarService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./BarService&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Services</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... other existed services</span>
  BarService<span class="token operator">:</span> BarService
<span class="token punctuation">}</span>
</code></pre></div><p>Then, add it to the <code>initializeServices</code> in <code>src/main/index.ts</code></p><div class="language-ts"><pre><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">initializeServices</span><span class="token punctuation">(</span>logger<span class="token operator">:</span> Logger<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// ...other services</span>
    BarService<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">BarService</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And this is ready to be used in renderer process by <code>useService(&#39;BarService&#39;)</code>. See <a href="#using-service-in-renderer">Using Service in Renderer</a>.</p><h4 id="using-other-service-in-a-service"><a class="header-anchor" href="#using-other-service-in-a-service" aria-hidden="true">#</a> Using Other Service in a Service</h4><p>If you need to use other <code>Service</code>, like <code>FooService</code>. You need to <code>@Inject</code> decorator to inject during runtime.</p><div class="language-ts"><pre><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">BarService</span> <span class="token keyword">extends</span> <span class="token class-name">Service</span> <span class="token punctuation">{</span>
  @<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token string">&#39;FooService&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> fooService<span class="token operator">:</span> FooService

  <span class="token keyword">async</span> <span class="token function">doSomeCoreLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fooService<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// perform some file system or network operations here</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="using-service-in-renderer"><a class="header-anchor" href="#using-service-in-renderer" aria-hidden="true">#</a> Using Service in Renderer</h4><p>You can directly access all the async methods in a service class by <code>useService(&#39;nameOfService&#39;)</code></p><p>Here is an example in <a href="./.html">About.vue</a>, using the <code>BaseService</code>.</p><div class="language-vue"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Vue logo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../assets/logo.png<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Electron Version: {{ version }} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Appdata Path: {{ path }} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Running Platform: {{ platform }} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>ts</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent<span class="token punctuation">,</span> reactive<span class="token punctuation">,</span> toRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../hooks&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> getBasicInformation <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useService</span><span class="token punctuation">(</span><span class="token string">&#39;BaseService&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      version<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
      platform<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">getBasicInformation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> version<span class="token punctuation">,</span> platform<span class="token punctuation">,</span> root <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      data<span class="token punctuation">.</span>version <span class="token operator">=</span> version
      data<span class="token punctuation">.</span>path <span class="token operator">=</span> root
      data<span class="token punctuation">.</span>platform <span class="token operator">=</span> platform
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span><span class="token function">toRefs</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="remove-service-infra"><a class="header-anchor" href="#remove-service-infra" aria-hidden="true">#</a> Remove Service Infra</h4><p>If you don&#39;t like Service design, you just easily remove it by</p><ol><li>Remove the whole <code>src/main/services</code> directory</li><li>Remove the import line <code>import { initialize } from &#39;./services&#39;</code> and initialization line <code>initialize(logger)</code> in <code>src/main/index.ts</code></li></ol><h3 id="static-resource"><a class="header-anchor" href="#static-resource" aria-hidden="true">#</a> Static Resource</h3><p>Place all your static resources under the <code>static</code> folder.</p><p>To use them in the main process, you just need to import them by <code>/@static/&lt;filename&gt;</code>.</p><p>For example, we have a <code>logo.png</code> in static folder, and we want to get it path in runtime:</p><div class="language-ts"><pre><code><span class="token keyword">import</span> logoPath <span class="token keyword">from</span> <span class="token string">&#39;/@static/logo.png&#39;</span> <span class="token comment">// this is the absolute path of the logo</span>
</code></pre></div><p>The plugin manage this is the <code>scripts/rollup.static.plugin.js</code>.</p><h3 id="preload-script"><a class="header-anchor" href="#preload-script" aria-hidden="true">#</a> Preload Script</h3><p>No matter you use the Service design or not, you will need to care about the preload script of the <code>BrowserWindow</code>.</p><p><em>If you don&#39;t know what is the preload script. You can read it in <a href="https://www.electronjs.org/docs/api/browser-window#new-browserwindowoptions" target="_blank" rel="noopener noreferrer">electron document about BrowserWindow</a>, and also the <a href="https://www.electronjs.org/docs/tutorial/security" target="_blank" rel="noopener noreferrer">security guideline</a>.</em></p><p>In this template, we have already setup the build script for preload. You can see all the preloads under <code>/src/preload</code>.</p><p>You must put the preload script under that folder. If you want to use it in main process. You can just import them by <code>import preloadPath from &#39;/@preload/&lt;your-preload-file&gt;&#39;</code></p><p>For example, if you add a new preload script named <code>/src/preload/my-preload.ts</code>, you can refer it while creating the <code>BrowserWindow</code>:</p><div class="language-ts"><pre><code><span class="token keyword">import</span> myPreloadPath <span class="token keyword">from</span> <span class="token string">&#39;/@preload/my-preload&#39;</span>

<span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  webPreferences<span class="token operator">:</span> <span class="token punctuation">{</span>
    preload<span class="token operator">:</span> myPreloadPath<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>The rollup config of preload is located at the <code>rollup.config.js</code>.</p><p>The preload script in <code>dist</code> will be built like <code>dist/&lt;name&gt;.preload.js</code>.</p><p>The plugin manage this process is located at <code>scripts/rollup.preload.plugin.js</code>.</p><h3 id="hooks-or-composable-in-renderer-process"><a class="header-anchor" href="#hooks-or-composable-in-renderer-process" aria-hidden="true">#</a> Hooks or Composable in Renderer Process</h3><p>One great feature of vue 3 is the <a href="https://v3.vuejs.org/api/composition-api.html" target="_blank" rel="noopener noreferrer">composition-api</a>. You can write up some basic piece of logic and compose them up during the setup functions. Currently, these <code>hooks</code> are placed in <code>/src/renderer/hooks</code> by default.</p><p>Take the example from vue composition api site, you have such code in <code>/src/renderer/hooks/mouse.ts</code></p><div class="language-ts"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> onUnmounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useMousePosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token keyword">function</span> <span class="token function">update</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">.</span>value <span class="token operator">=</span> e<span class="token punctuation">.</span>pageX
    y<span class="token punctuation">.</span>value <span class="token operator">=</span> e<span class="token punctuation">.</span>pageY
  <span class="token punctuation">}</span>

  <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousemove&#39;</span><span class="token punctuation">,</span> update<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;mousemove&#39;</span><span class="token punctuation">,</span> update<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You&#39;d better to export this <code>mouse.ts</code> to <code>/src/renderer/hooks/index.ts</code></p><div class="language-ts"><pre><code><span class="token comment">// other exports...</span>

<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">&#39;./mouse.ts&#39;</span>
</code></pre></div><p>Then in the <code>vue</code> file you can import all hooks by the alias path</p><div class="language-vue"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  ...template content
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>ts</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useMousePosition <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;/@/hooks&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useMousePosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// other logic</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="electron-api-in-renderer-process"><a class="header-anchor" href="#electron-api-in-renderer-process" aria-hidden="true">#</a> Electron API in Renderer Process</h3><p>The boilplate exposes several electron APIs by default. You can access them by <code>useShell</code>, <code>useClipboard</code>, <code>useIpc</code> and <code>useDialog</code>. <em>These are provided by <code>static/preload.js</code> script. If you remove the preload during the creation of this BrowserWindow, this won&#39;t work.</em></p><div class="language-ts"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useShell <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;/@/hooks&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> shell <span class="token operator">=</span> <span class="token function">useShell</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// this is equivalence to the import { shell } from &#39;electron&#39; normally</span>
    <span class="token comment">// the shell object type definition works normally</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>The only exception is the <code>useDialog</code>. You can only use <code>async</code> functions in it as the API call goes through IPC and it must be <code>async</code>.</p><h3 id="dependencies"><a class="header-anchor" href="#dependencies" aria-hidden="true">#</a> Dependencies</h3><p>If you adding a new dependency, make sure if it&#39;s using any <strong>nodejs</strong> module, add it as <code>external</code> in the <code>package.json</code>. Otherwise, the vite will complain about &quot;I cannot handle it!&quot;.</p><div class="language-json"><pre><code><span class="token punctuation">{</span>
  <span class="token comment">// ...other package.json content</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...other dependencies</span>
    <span class="token property">&quot;a-nodejs-package&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;version&gt;&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;external&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// ...other existed excluded packages</span>
    <span class="token string">&quot;a-nodejs-package&quot;</span> <span class="token comment">// your new package</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// ...rest of package.json</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The raw javascript dependencies are okay for vite.</p><h4 id="native-dependencies"><a class="header-anchor" href="#native-dependencies" aria-hidden="true">#</a> Native Dependencies</h4><p>If you want to use the native dependencies, which need to compile when install, usually, you need <a href="https://github.com/nodejs/node-gyp" target="_blank" rel="noopener noreferrer">node-gyp</a> to build, the <code>electron-builder</code> will rebuild it upon your electron for you. Normally you don&#39;t need to worry much. Notice that if you are in Windows, you might want to install <a href="https://github.com/felixrieseberg/windows-build-tools" target="_blank" rel="noopener noreferrer">windows-build-tools</a> to install the compile toolchain.</p><h4 id="dependencies-contains-compiled-binary"><a class="header-anchor" href="#dependencies-contains-compiled-binary" aria-hidden="true">#</a> Dependencies Contains Compiled Binary</h4><p>If you want to use the dependencies containing the compiled binary, not only you should adding it to vite <code>exclude</code>, you should also take care about the electron-builder config. See the <a href="#exclude-files">Build</a> section for detail. The development process won&#39;t affect much by it.</p><h3 id="new-window"><a class="header-anchor" href="#new-window" aria-hidden="true">#</a> New Window</h3><ol><li>Add a new html file under the <code>src/renderer</code></li><li>Reference some typescript/javascript file in you new added html file</li><li>Add a code block in your <code>src/main/index.ts</code> to control the creation of this window</li></ol><p>For example, you just added a <code>side.html</code> under the <code>src/renderer</code>. You need to add such controller code in <code>index.ts</code>:</p><div class="language-ts"><pre><code><span class="token keyword">import</span> preload <span class="token keyword">from</span> <span class="token string">&#39;/@preload/index&#39;</span>

<span class="token comment">// This function should be called once app is ready</span>
<span class="token keyword">function</span> <span class="token function">createANewWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// this part is the same as before, modify it as your wish</span>
  <span class="token keyword">const</span> win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    height<span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
    width<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
    webPreferences<span class="token operator">:</span> <span class="token punctuation">{</span>
      preload<span class="token punctuation">,</span>
      contextIsolation<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      nodeIntegration<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// __windowUrls.side is pointing to the real url of `side.html`</span>
  win<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span>__windowUrls<span class="token punctuation">.</span>side<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>The <code>scripts/vite.config.js</code> will automatically scan all html files under the <code>src/renderer</code>. So, you do not need to touch the any vite/rollup config files. But, if you want more customization, you can refer the <a href="https://vitejs.dev/guide/build.html#multi-page-app" target="_blank" rel="noopener noreferrer">official vite document</a> about the multi-page app!</p><h3 id="worker-threads"><a class="header-anchor" href="#worker-threads" aria-hidden="true">#</a> Worker Threads</h3><p>If you want to use <a href="https://nodejs.org/api/worker_threads.html" target="_blank" rel="noopener noreferrer">worker_threads</a> in main process, you need separately load the <code>Worker</code> script. The template already setup the build/bundle process of the <code>Worker</code> script. Normally, you do not need to modify this build process.</p><p>You just need to import the worker script by ending a <code>?worker</code> query in import.</p><p>If you have a new worker file named <code>src/main/workers/sha256.ts</code>, you can access it in main process like:</p><div class="language-ts"><pre><code><span class="token keyword">import</span> createSha256Worker <span class="token keyword">from</span> <span class="token string">&#39;./workers/sha256?worker&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Worker <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;worker_threads&#39;</span>

<span class="token keyword">const</span> worker<span class="token operator">:</span> Worker <span class="token operator">=</span> <span class="token function">createSha256Worker</span><span class="token punctuation">(</span><span class="token comment">/* options */</span><span class="token punctuation">)</span>
</code></pre></div><p>The worker thread files are built together with the normal main process code. They are under the same config in <code>rollup.config.js</code>.</p><p>In <code>dist</code>, The worker script will be compiled as <code>dist/&lt;name&gt;.worker.js</code>.</p><h3 id="debugging"><a class="header-anchor" href="#debugging" aria-hidden="true">#</a> Debugging</h3><p>This is really simple. In vscode debug section, you will see three profiles:</p><ol><li>Electron: Main (attach)</li><li>Electron: Renderer (attach)</li><li>Electron: Main &amp; Renderer (attach)</li></ol><div class="language-json"><pre><code><span class="token punctuation">{</span>
    <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;configurations&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Electron: Main (attach)&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;request&quot;</span><span class="token operator">:</span> <span class="token string">&quot;attach&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;cwd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;${workspaceFolder}&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;outFiles&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;${workspaceFolder}/dist/**/*.js&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;smartStep&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sourceMaps&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;inspector&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">5858</span><span class="token punctuation">,</span>
            <span class="token property">&quot;timeout&quot;</span><span class="token operator">:</span> <span class="token number">20000</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Electron: Renderer (attach)&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;chrome&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;request&quot;</span><span class="token operator">:</span> <span class="token string">&quot;attach&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">9222</span><span class="token punctuation">,</span>
            <span class="token property">&quot;webRoot&quot;</span><span class="token operator">:</span> <span class="token string">&quot;${workspaceFolder}&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;timeout&quot;</span><span class="token operator">:</span> <span class="token number">15000</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;compounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Electron: Main &amp; Renderer (attach)&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;configurations&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Electron: Main (attach)&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Electron: Renderer (attach)&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The name should be clear. The first one attach to main and the second one attach to renderer (required vscode chrome debug extension). The third one is run the 1 and 2 at the same time.</p><p>You should first run <code>npm run dev</code> and start debugging by the vscode debug.</p><h3 id="option-using-node-modules-in-renderer-process"><a class="header-anchor" href="#option-using-node-modules-in-renderer-process" aria-hidden="true">#</a> Option: Using Node Modules in Renderer Process</h3><p>By default, the renderer process environment is just a raw front-end environment. You cannot use any nodejs module here. (Use service alternative)</p><p>If you just want to use node modules in electron renderer/browser side anyway, you can just enable the <code>nodeIntegration</code> in BrowserWindow creation.</p><p>For example, you can enable the main window node integration like this:</p><div class="language-ts"><pre><code><span class="token keyword">const</span> mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  height<span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
  width<span class="token operator">:</span> <span class="token number">800</span><span class="token punctuation">,</span>
  webPreferences<span class="token operator">:</span> <span class="token punctuation">{</span>
    preload<span class="token operator">:</span> <span class="token function">join</span><span class="token punctuation">(</span>__static<span class="token punctuation">,</span> <span class="token string">&#39;preload.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nodeIntegration<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// adding this to enable the node integration</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="build"><a class="header-anchor" href="#build" aria-hidden="true">#</a> Build</h2><p>The project build is based on <a href="https://github.com/electron-userland/electron-builder" target="_blank" rel="noopener noreferrer">electron-builder</a>. The config file is majorly in <a href="https://github.com/ci010/electron-vue-next/tree/master/electron-vue-next/scripts/build.base.config.js" target="_blank" rel="noopener noreferrer">scripts/build.base.config.js</a>. And you can refer the electron-builder <a href="https://www.electron.build/" target="_blank" rel="noopener noreferrer">document</a>.</p><h3 id="compile"><a class="header-anchor" href="#compile" aria-hidden="true">#</a> Compile</h3><p>The project will compile typescript/vue source code by rollup into javascript production code. The rollup config for main process is in <a href="https://github.com/ci010/electron-vue-next/tree/master/electron-vue-next/scripts/rollup.config.js" target="_blank" rel="noopener noreferrer">rollup.config.js</a>. It will output the production code to <code>dist/index.js</code>.</p><p>Notice that by default, this project&#39;s rollup config won&#39;t bundle the nodejs dependencies used in main process. As the rollup is based on esm, it has a hard time to resolve some circular dependencies problems, which can happen frequently in some nodejs package (e.g. electron-updater, Webpack can handle these kind of problem though). Once you put them into the <code>external</code> in <code>package.json</code>, they will be packed in the <code>node_modules</code> in output asar. Just let you know that this is not like webpack, bundling them into your <code>index.js</code>.</p><p>The config to compile renderer process is in <a href="https://github.com/ci010/electron-vue-next/tree/master/electron-vue-next/scripts/vite.config.js" target="_blank" rel="noopener noreferrer">vite.config.js</a>. It will compile the production code into <code>dist/renderer/*</code>.</p><h4 id="speed-up-compile"><a class="header-anchor" href="#speed-up-compile" aria-hidden="true">#</a> Speed Up Compile</h4><p>If you feel the compile time is too long, this is majorly caused by typecheck for main process code.</p><p>You can set the wait to typescript plugin to false in <code>rollup.config.js</code> to skip type check to dev.</p><div class="language-ts"><pre><code><span class="token function">pluginTypescript</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  tsconfig<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;../src/main/tsconfig.json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;../src/preload/tsconfig.json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  wait<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// add this to not wait the type error result</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><p>You will still see the typecheck result, but the build won&#39;t be prevent if the typecheck failed.</p><p>If you still think the compile is slow, you can just remove this plugin from <code>rollup.config.js</code></p><h3 id="exclude-files"><a class="header-anchor" href="#exclude-files" aria-hidden="true">#</a> Exclude Files</h3><p>Normally, once you correctly config the <code>dependencies</code> in <a href="#development">Development</a> section, you should not worry to much about the build. But some dependencies contains compiled binary. You might want to exclude them out of the unrelated OS builds.</p><p>For example, <a href="https://github.com/onikienko/7zip-min" target="_blank" rel="noopener noreferrer">7zip-min</a>:</p><p>Since it using the <code>7zip-bin</code> which carry binary for multiple platform, we need to correctly include them in config. Modify the electron-builder build script <code>build.base.config.js</code></p><div class="language-js"><pre><code>  asarUnpack<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;node_modules/7zip-bin/**/*&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>Add them to <code>asarUnpack</code> to ensure the electron builder correctly pack &amp; unpack them.</p><p>To optimize for multi-platform, you should also exclude them from <code>files</code> of each platform config <code>build.config.js</code></p><div class="language-js"><pre><code>  mac<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ... other mac configs</span>
    files<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;node_modules/7zip-bin/**/*&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;!node_modules/7zip-bin/linux/**&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;!node_modules/7zip-bin/win/**&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  win<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ... other win configs</span>
    files<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;node_modules/7zip-bin/**/*&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;!node_modules/7zip-bin/linux/**&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;!node_modules/7zip-bin/mac/**&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  linux<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ... other linux configs</span>
    files<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;node_modules/7zip-bin/**/*&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;!node_modules/7zip-bin/win/**&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;!node_modules/7zip-bin/mac/**&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="release"><a class="header-anchor" href="#release" aria-hidden="true">#</a> Release</h2><p>The out-of-box github action will validate each your PR by eslint and run <code>npm run build</code>. It will not trigger electron-builder to build production assets.</p><p>For each push in master branch, it will build production assets for win/mac/linux platform and upload it as github action assets. It will also create a <strong>pull request</strong> to asking you to bump version and update the changelog.</p><p>It using the conventional-commit. If you want to auto-generate the changelog, you should follow the <a href="https://www.conventionalcommits.org/en/v1.0.0" target="_blank" rel="noopener noreferrer">conventional commit guideline</a>.</p><p>If the <strong>bump version PR</strong> is approved and merged to master, it will auto build and release to github release.</p><p><strong>If you want to disable this github action release process, just remove the <a href="https://github.com/ci010/electron-vue-next/tree/master/electron-vue-next/.github/workflows/build.yml" target="_blank" rel="noopener noreferrer">.github/workflows/build.yml</a> file.</strong></p><h3 id="autoupdate-support"><a class="header-anchor" href="#autoupdate-support" aria-hidden="true">#</a> AutoUpdate Support</h3><p>This boilerplate include the <a href="https://github.com/electron-userland/electron-builder/tree/master/packages/electron-updater" target="_blank" rel="noopener noreferrer">electron-updater</a> as dependencies by default. You can follow the <a href="https://github.com/electron-userland/electron-builder" target="_blank" rel="noopener noreferrer">electron-builder</a> guideline to implement the autoUpdate process.</p></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><!----></div></div><div class="updated" data-v-fb8d84c6><p class="last-updated" data-v-fb8d84c6 data-v-5797b537><span class="prefix" data-v-5797b537>Last Updated:</span><span class="datetime" data-v-5797b537></span></p></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"684eda04\",\"zh_index.md\":\"70c497e2\"}")</script>
    <script type="module" async src="/electron-vue-next/assets/app.dc01decd.js"></script>
  </body>
</html>